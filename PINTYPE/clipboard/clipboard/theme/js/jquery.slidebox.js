jQuery(document).ready(function(e){e.fn.Slidebox=function(t){function n(t){parseInt(t.css("max-height").replace("px","")),parseInt(t.css("max-width").replace("px","")),t.width()>=e(window).width()-120&&t.height()<=e(window).height()-100?t.width(e(window).width()-120).height("auto"):t.height()>=e(window).height()-100?t.height(e(window).height()-100).width("auto"):t.width()<e(window).width()-120&&t.height()>e(window).height()-100?t.width(e(window).width()-120).height("auto"):t.height()<e(window).height()-100&&t.height(e(window).height()-100).width("auto"),t.width()>=e(window).width()-120&&t.height()<=e(window).height()-100?t.width(e(window).width()-120).height("auto"):t.height()>=e(window).height()-100?t.height(e(window).height()-100).width("auto"):t.width()<e(window).width()-120&&t.height()>e(window).height()-100?t.width(e(window).width()-120).height("auto"):t.height()<e(window).height()-100&&t.height(e(window).height()-100).width("auto")}function i(){e("a",l).not("#SBCLOSE").unbind("click").unbind("hover"),m>0&&(e(".nextImage").hover(function(){e(this).stop().animate({left:"-"+h.imageHangHover+"px"},m)},function(){e(this).stop().animate({left:"0px"},m)}),e(".prevImage").hover(function(){e(this).stop().animate({left:h.imageHangHover+"px"},m)},function(){e(this).stop().animate({left:"0px"},m)})),e(".currentImage").click(function(){return c.fadeOut(200),l.fadeOut(200,0,function(){e("a",l).not("#SBCLOSE").remove(),e(this).hide(),s.fadeOut(200,0,function(){e(this).hide()})}),!1}),e(".nextImage").click(function(){return e("a",l).not("#SBCLOSE").unbind("click").unbind("hover"),m>0&&"snap"!=h.transitionType?e(".nextImage, .prevImage").animate({left:0},m):"snap"==h.transitionType&&e(".nextImage, .prevImage").css({left:0},m),e.when(e("a img",l).fadeTo(f,p)).done(function(){if(o++,o+1<a.length)var t=a.get(o+1);else var t=directory+"/theme/images/blank.png";l.append('<a href="#" class="nextNextImage SBLINK"><img src="'+t+'"></a>'),e(".nextNextImage img",l).load(function(){e(".nextNextImage").css("opacity","0"),e(this).css({"max-height":e(this).height(),"max-width":e(this).width()}),n(e(this));var r=e(this);r.fadeTo(0,p).css({marginTop:(e(window).height()-r.height())/2+"px"}),r.parent().css({marginTop:(e(window).height()-r.height())/2+"px"}).animate({marginLeft:e(window).width()-h.imageHang+"px"},h.transitionSpeed,function(){t==directory+"/theme/images/blank.png"&&e(this).hide(),e(this).removeClass("nextNextImage").addClass("nextImage"),("fade"==h.transitionType||1==h.slideFade)&&e("img",this).fadeTo(f,1),i(),e(".nextImage").css("opacity","1")}),e(".prevImage").animate({marginLeft:"-"+e(window).width()+"px"},h.transitionSpeed,function(){e(this).remove(),"fade"==h.transitionType&&e("img",this).fadeTo(f,1),i()}),e(".currentImage").animate({marginLeft:"-"+(e(".currentImage").width()-h.imageHang)+"px"},h.transitionSpeed,function(){e(this).removeClass("currentImage").addClass("prevImage"),("fade"==h.transitionType||1==h.slideFade)&&e("img",this).fadeTo(f,1),i()}),e(".nextImage").animate({marginLeft:(e(window).width()-e(".nextImage").width())/2+"px"},h.transitionSpeed,function(){e(this).removeClass("nextImage").addClass("currentImage"),("fade"==h.transitionType||1==h.slideFade)&&e("img",this).fadeTo(f,1),i()})})}),!1}),e(".prevImage").click(function(){return e("a",l).not("#SBCLOSE").unbind("click").unbind("hover"),m>0&&"snap"!=h.transitionType?e(".nextImage, .prevImage").animate({left:0},m):"snap"==h.transitionType&&e(".nextImage, .prevImage").css({left:0},m),e.when(e("a img",l).fadeTo(f,p)).done(function(){if(e("a",l).not("#SBCLOSE").unbind("click"),o--,o>0)var t=a.get(o-1);else var t=directory+"/theme/images/blank.png";l.prepend('<a href="#" class="prevPrevImage SBLINK"><img src="'+t+'"></a>'),e(".prevPrevImage img",l).load(function(){e(".prevPrevImage").css("opacity","0"),e(this).css({"max-height":e(this).height(),"max-width":e(this).width()}),n(e(this));var r=e(this);r.fadeTo(0,p).css({marginTop:(e(window).height()-r.height())/2+"px"}),r.parent().css({marginTop:(e(window).height()-r.height())/2+"px"}).animate({marginLeft:"-"+(r.width()-h.imageHang)+"px"},h.transitionSpeed,function(){t==directory+"/theme/images/blank.png"&&e(this).hide(),e(this).removeClass("prevPrevImage").addClass("prevImage"),("fade"==h.transitionType||1==h.slideFade)&&e("img",this).fadeTo(f,1),i(),e(".prevImage").css("opacity","1")}),e(".prevImage").animate({marginLeft:(e(window).width()-e(".prevImage").width())/2+"px"},h.transitionSpeed,function(){e(this).removeClass("prevImage").addClass("currentImage"),("fade"==h.transitionType||1==h.slideFade)&&e("img",this).fadeTo(f,1),i()}),e(".currentImage").animate({marginLeft:e(window).width()-h.imageHang+"px"},h.transitionSpeed,function(){e(this).removeClass("currentImage").addClass("nextImage"),("fade"==h.transitionType||1==h.slideFade)&&e("img",this).fadeTo(f,1),i()}),e(".nextImage").animate({marginLeft:2*e(window).width()+"px"},h.transitionSpeed,function(){e(this).remove(),("fade"==h.transitionType||1==h.slideFade)&&e("img",this).fadeTo(f,1),i()})})}),!1})}var r=e("#directoryRef").attr("data-loading");0==e("#SBBG").length&&e("body").append('<a href="#" id="SBBG"></a><div href="#" id="SBCO"><a class="milClose" id="SBCLOSE" href="#"></a><div id="slide_loadtext">'+r+"</div></div>");var a=e(this),o=0,s=e("#SBBG"),l=e("#SBCO"),c=e("#slide_loadtext"),u=e(".milClose"),d={bgOpacity:.9,bgColor:"#000000",fadeSpeed:0,transitionSpeed:0,transitionType:"snap",imageHang:200,imageHangHover:0,slideFade:0,slideFadeOpacity:1};directory=e("#directoryRef").attr("data-directory");var h=e.extend(d,t);if(s.css({display:"none","background-color":h.bgColor}),"fade"==h.transitionType)var p=0,f=h.transitionSpeed;else if(1==h.slideFade&&"slide"==h.transitionType)var p=h.slideFadeOpacity,f=h.transitionSpeed;else var p=1,f=1;var m=0;h.imageHangHover>0&&(m=100),("snap"==h.transitionType||"fade"==h.transitionType)&&(h.transitionSpeed=1),a.click(function(){e("body").hasClass("ie8")&&e(".ie8 .format-audio iframe").hide();var t,r;return o=a.index(e(this)),l.fadeIn(200),c.hide(),setTimeout(function(){c.fadeIn(200)},300),s.fadeIn(200),t=void 0!=a.get(a.index(e(this))+1)?'<a href="#" class="nextImage SBLINK"><img src="'+a.get(a.index(e(this))+1)+'"></a>':"",r=a.index(e(this))>0?'<a href="#" class="prevImage SBLINK"><img src="'+a.get(a.index(e(this))-1)+'"></a>':"",l.append(r+'<a href="#" class="currentImage SBLINK"><img src="'+e(this).attr("href")+'"></a>'+t),e(".SBLINK img").each(function(){var t=e(this).parent(),i=e(this);i.load(function(){i.fadeTo(0,0,function(){i.css({"max-height":i.height(),"max-width":i.width()}),n(i),t.hasClass("prevImage")&&e(".prevImage").css({marginLeft:"-"+(e(".prevImage").width()-h.imageHang)+"px"}),t.hasClass("currentImage")&&e(".currentImage").css({marginLeft:(e(window).width()-e(".currentImage").width())/2+"px"}),t.hasClass("nextImage")&&e(".nextImage").css({marginLeft:e(window).width()-h.imageHang+"px"}),t.css({marginTop:(e(window).height()-i.height())/2+"px"}),e(this).fadeTo(300,1)})})}),i(),!1}),u.click(function(){return c.fadeOut(200),l.fadeOut(200,0,function(){e("body").hasClass("ie8")&&e(".ie8 .format-audio iframe").show(),e("a",l).not("#SBCLOSE").remove(),e(this).hide(),s.fadeOut(200,0,function(){e(this).hide()})}),!1}),e(window).resize(function(){e(".SBLINK img").each(function(){var t=e(this);console.log(t.height()),n(t),t.parent().css({marginTop:(e(window).height()-t.height())/2+"px"})}),e(".prevImage").css({marginLeft:"-"+(e(".prevImage").width()-h.imageHang)+"px"}),e(".currentImage").css({marginLeft:(e(window).width()-e(".currentImage").width())/2+"px"}),e(".nextImage").css({marginLeft:e(window).width()-h.imageHang+"px"})})}});